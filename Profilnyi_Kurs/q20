ВЫБРАТЬ
    Товары.Дата КАК Дата,
    Товары.Контрагент,
    Товары.ДоговорКонтрагента,
    Товары.НоменклатурнаяГруппа,
    Товары.Количество КАК КоличествоТоваров,
    Товары.Сумма КАК СуммаТоваров,
    Товары.СчетУчета,
    Услуги.Количество КАК КоличествоУслуг,
    Услуги.Сумма КАК СуммаУслуг,
    Факт.Количество КАК КоличествоФакт,
    Факт.Сумма КАК СуммаФакт
ИЗ
(
    /////////////////////// ТОВАРЫ //////////////////////
    ВЫБРАТЬ
        Реализация.Дата КАК Дата,
        Реализация.Контрагент,
        Реализация.ДоговорКонтрагента,
        РТУТовары.Субконто КАК НоменклатурнаяГруппа,
        СУММА(РТУТовары.Количество) КАК Количество,
        СУММА(РТУТовары.Сумма) КАК Сумма,
        РТУТовары.СчетРасходов КАК СчетУчета
    ИЗ
        Документ.РеализацияТоваровУслуг КАК Реализация
            ЛЕВОЕ СОЕДИНЕНИЕ Документ.РеализацияТоваровУслуг.Товары КАК РТУТовары
            ПО Реализация.Ссылка = РТУТовары.Ссылка
    ГДЕ
        Реализация.Проведен
        И Реализация.Дата МЕЖДУ &ДатаНачала И &ДатаОкончания
        И Реализация.Склад.Наименование ПОДОБНО "%Склад отгрузки готовой продукции%"
        И СОКРЛ(СОКРП(Реализация.ПодразделениеОрганизации.Код)) = "53"
    СГРУППИРОВАТЬ ПО
        Реализация.Контрагент,
        Реализация.ДоговорКонтрагента,
        Реализация.Дата,
        РТУТовары.Субконто,
        РТУТовары.СчетРасходов
) КАК Товары
ЛЕВОЕ СОЕДИНЕНИЕ
(
    /////////////////////// УСЛУГИ //////////////////////
    ВЫБРАТЬ
        Реализация.Контрагент,
        Реализация.ДоговорКонтрагента,
        РТУУслуги.Субконто КАК НоменклатурнаяГруппа,
        СУММА(РТУУслуги.Количество) КАК Количество,
        СУММА(РТУУслуги.Сумма) КАК Сумма
    ИЗ
        Документ.РеализацияТоваровУслуг КАК Реализация
            ЛЕВОЕ СОЕДИНЕНИЕ Документ.РеализацияТоваровУслуг.Услуги КАК РТУУслуги
            ПО Реализация.Ссылка = РТУУслуги.Ссылка
    ГДЕ
        Реализация.Проведен
        И Реализация.Дата МЕЖДУ &ДатаНачала И &ДатаОкончания
        И Реализация.Склад.Наименование ПОДОБНО "%Склад отгрузки готовой продукции%"
        И СОКРЛ(СОКРП(Реализация.ПодразделениеОрганизации.Код)) = "53"
    СГРУППИРОВАТЬ ПО
        Реализация.Контрагент,
        Реализация.ДоговорКонтрагента,
        РТУУслуги.Субконто
) КАК Услуги
ПО
    Товары.Контрагент = Услуги.Контрагент
    И Товары.ДоговорКонтрагента = Услуги.ДоговорКонтрагента
    И Товары.НоменклатурнаяГруппа = Услуги.НоменклатурнаяГруппа
ЛЕВОЕ СОЕДИНЕНИЕ
(
    /////////////////////// ФАКТ //////////////////////
    ВЫБРАТЬ
        Факт.Контрагент,
        Факт.ДоговорКонтрагента,
        Факт.НоменклатурнаяГруппа,
        СУММА(Факт.Количество) КАК Количество,
        СУММА(Факт.Сумма) КАК Сумма
    ИЗ
        Документ.бит_ПолучениеФактическихДанных.ФактическиеДанные КАК Факт
    ГДЕ
        Факт.Ссылка.Проведен
        И Факт.Период МЕЖДУ &ДатаНачала И &ДатаОкончания
        И Факт.Ссылка.Сценарий.Наименование = "ФАКТ"
        И Факт.СтатьяОборотов.ТипСтатьи = ЗНАЧЕНИЕ(Перечисление.бит_ТипыСтатейОборотов.БДР)
        И Факт.СтатьяОборотов.Кодификатор ПОДОБНО "11.42.0[0-4][0-3]%"
    СГРУППИРОВАТЬ ПО
        Факт.Контрагент,
        Факт.ДоговорКонтрагента,
        Факт.НоменклатурнаяГруппа
) КАК Факт
ПО
    Товары.Контрагент = Факт.Контрагент
    И Товары.ДоговорКонтрагента = Факт.ДоговорКонтрагента
    И Товары.НоменклатурнаяГруппа = Факт.НоменклатурнаяГруппа
