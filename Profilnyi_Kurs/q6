ВЫБРАТЬ
    Данные.Дата,
    Данные.Контрагент,
    Данные.ДоговорКонтрагента,
    Данные.НоменклатурнаяГруппа,

    СУММА(Данные.ПланКоличество) КАК ПланКоличество,
    СУММА(Данные.ПланСумма) КАК ПланСумма,

    СУММА(Данные.ФактКоличество) КАК ФактКоличество,
    СУММА(Данные.ФактСумма) КАК ФактСумма

ИЗ
(
    ///////////////////////
    //       П Л А Н     //
    ///////////////////////

    ВЫБРАТЬ
        Реализация.Дата КАК Дата,
        Реализация.Контрагент КАК Контрагент,
        Реализация.ДоговорКонтрагента КАК ДоговорКонтрагента,
        ЕСТЬNULL(РТУТовары.Субконто, РТУУслуг.Субконто) КАК НоменклатурнаяГруппа,

        СУММА(ЕСТЬNULL(РТУТовары.Количество, 0) + ЕСТЬNULL(РТУУслуг.Количество, 0)) КАК ПланКоличество,
        СУММА(ЕСТЬNULL(РТУТовары.Сумма, 0) + ЕСТЬNULL(РТУУслуг.Сумма, 0)) КАК ПланСумма,

        0 КАК ФактКоличество,
        0 КАК ФактСумма

    ИЗ
        Документ.РеализацияТоваровУслуг КАК Реализация

        ЛЕВОЕ СОЕДИНЕНИЕ Документ.РеализацияТоваровУслуг.Товары КАК РТУТовары
            ПО Реализация.Ссылка = РТУТовары.Ссылка

        ЛЕВОЕ СОЕДИНЕНИЕ Документ.РеализацияТоваровУслуг.Услуги КАК РТУУслуг
            ПО Реализация.Ссылка = РТУУслуг.Ссылка

    ГДЕ
        Реализация.Проведен
        И Реализация.Дата МЕЖДУ &ДатаНачала И &ДатаОкончания
        И Реализация.Склад.Наименование ПОДОБНО "%Склад отгрузки готовой продукции%"
        И СОКРЛ(СОКРП(Реализация.ПодразделениеОрганизации.Код)) = "53"

    СГРУППИРОВАТЬ ПО
        Реализация.Дата,
        Реализация.Контрагент,
        Реализация.ДоговорКонтрагента,
        ЕСТЬNULL(РТУТовары.Субконто, РТУУслуг.Субконто)

    ОБЪЕДИНИТЬ ВСЕ

    ///////////////////////
    //       Ф А К Т     //
    ///////////////////////

    ВЫБРАТЬ
        ФактическиеДанные.Период КАК Дата,
        ФактическиеДанные.Контрагент КАК Контрагент,
        ФактическиеДанные.ДоговорКонтрагента КАК ДоговорКонтрагента,
        ФактическиеДанные.НоменклатурнаяГруппа КАК НоменклатурнаяГруппа,

        0 КАК ПланКоличество,
        0 КАК ПланСумма,

        СУММА(ФактическиеДанные.Количество) КАК ФактКоличество,
        СУММА(ФактическиеДанные.Сумма) КАК ФактСумма

    ИЗ
        Документ.бит_ПолучениеФактическихДанных.ФактическиеДанные КАК ФактическиеДанные

    ГДЕ
        ФактическиеДанные.Ссылка.Проведен
        И ФактическиеДанные.Период МЕЖДУ &ДатаНачала И &ДатаОкончания
        И ФактическиеДанные.Ссылка.Сценарий.Наименование = "ФАКТ"
        И ФактическиеДанные.СтатьяОборотов.ТипСтатьи = ЗНАЧЕНИЕ(Перечисление.бит_ТипыСтатейОборотов.БДР)
        И ФактическиеДанные.СтатьяОборотов.Кодификатор ПОДОБНО "11.42.0[0-4][0-3]%"

    СГРУППИРОВАТЬ ПО
        ФактическиеДанные.Период,
        ФактическиеДанные.Контрагент,
        ФактическиеДанные.ДоговорКонтрагента,
        ФактическиеДанные.НоменклатурнаяГруппа
) КАК Данные

СГРУППИРОВАТЬ ПО
    Дата,
    Контрагент,
    ДоговорКонтрагента,
    НоменклатурнаяГруппа
