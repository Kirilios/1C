ВЫБРАТЬ 
    Дата,
    Контрагент,
    ДоговорКонтрагента,
    НоменклатурнаяГруппа,
    МАКСИМУМ(КоличествоТовары) КАК Количество,
    СУММА(СуммаУслуг) КАК Сумма,
    СчетУчета
ИЗ (
    ///////////////////// ТОВАРЫ ///////////////////////
    ВЫБРАТЬ
        Реализация.Дата КАК Дата,
        Реализация.Контрагент КАК Контрагент,
        Реализация.ДоговорКонтрагента КАК ДоговорКонтрагента,
        РТУТовары.Субконто КАК НоменклатурнаяГруппа,
        Реализация.ВидОперации КАК ВидОперации,
        СУММА(РТУТовары.Количество) КАК КоличествоТовары,
        0 КАК СуммаУслуг,
        РТУТовары.СчетРасходов КАК СчетУчета
    ИЗ
        Документ.РеализацияТоваровУслуг КАК Реализация
        ЛЕВОЕ СОЕДИНЕНИЕ Документ.РеализацияТоваровУслуг.Товары КАК РТУТовары
        ПО Реализация.Ссылка = РТУТовары.Ссылка
    ГДЕ
        Реализация.Проведен
        И Реализация.Дата МЕЖДУ &ДатаНачала И &ДатаОкончания
        И Реализация.Склад.Наименование ПОДОБНО "%Склад отгрузки готовой продукции%"
        И СОКРЛ(СОКРП(Реализация.ПодразделениеОрганизации.Код)) = "53"
    СГРУППИРОВАТЬ ПО
        Реализация.Контрагент,
        Реализация.ДоговорКонтрагента,
        Реализация.Дата,
        РТУТовары.Субконто,
        РТУТовары.СчетРасходов,
        Реализация.ВидОперации

    ОБЪЕДИНИТЬ ВСЕ

    /////////////////// УСЛУГИ /////////////////////////
    ВЫБРАТЬ
        Реализация.Дата КАК Дата,
        Реализация.Контрагент КАК Контрагент,
        Реализация.ДоговорКонтрагента КАК ДоговорКонтрагента,
        РТУУслуги.Субконто КАК НоменклатурнаяГруппа,
        Реализация.ВидОперации КАК ВидОперации,
        0 КАК КоличествоТовары,
        СУММА(РТУУслуги.Сумма) КАК СуммаУслуг,
        0 КАК СчетУчета
    ИЗ
        Документ.РеализацияТоваровУслуг КАК Реализация
        ЛЕВОЕ СОЕДИНЕНИЕ Документ.РеализацияТоваровУслуг.Услуги КАК РТУУслуги
        ПО Реализация.Ссылка = РТУУслуги.Ссылка
    ГДЕ
        Реализация.Проведен
        И Реализация.Дата МЕЖДУ &ДатаНачала И &ДатаОкончания
        И Реализация.Склад.Наименование ПОДОБНО "%Склад отгрузки готовой продукции%"
        И СОКРЛ(СОКРП(Реализация.ПодразделениеОрганизации.Код)) = "53"
    СГРУППИРОВАТЬ ПО
        Реализация.Дата,
        Реализация.Контрагент,
        Реализация.ДоговорКонтрагента,
        РТУУслуги.Субконто,
        Реализация.ВидОперации

    ОБЪЕДИНИТЬ ВСЕ

    /////////////////// ФАКТ ////////////////////////////
    ВЫБРАТЬ
        ФактическиеДанные.Период КАК Дата,
        ФактическиеДанные.Контрагент КАК Контрагент,
        ФактическиеДанные.ДоговорКонтрагента КАК ДоговорКонтрагента,
        ФактическиеДанные.НоменклатурнаяГруппа КАК НоменклатурнаяГруппа,
        NULL КАК ВидОперации,
        СУММА(ФактическиеДанные.Количество) КАК КоличествоТовары,
        СУММА(ФактическиеДанные.Сумма) КАК СуммаУслуг,
        0 КАК СчетУчета
    ИЗ
        Документ.бит_ПолучениеФактическихДанных.ФактическиеДанные КАК ФактическиеДанные
    ГДЕ
        ФактическиеДанные.Ссылка.Проведен
        И ФактическиеДанные.Период МЕЖДУ &ДатаНачала И &ДатаОкончания
        И ФактическиеДанные.Ссылка.Сценарий.Наименование = "ФАКТ"
        И ФактическиеДанные.СтатьяОборотов.ТипСтатьи =
            ЗНАЧЕНИЕ(Перечисление.бит_ТипыСтатейОборотов.БДР)
        И ФактическиеДанные.СтатьяОборотов.Кодификатор ПОДОБНО "11.42.0[0-4][0-3]%"
    СГРУППИРОВАТЬ ПО
        ФактическиеДанные.ДоговорКонтрагента,
        ФактическиеДанные.Контрагент,
        ФактическиеДанные.НоменклатурнаяГруппа,
        ФактическиеДанные.Период
) КАК Подзапрос

СГРУППИРОВАТЬ ПО
    Дата,
    Контрагент,
    ДоговорКонтрагента,
    НоменклатурнаяГруппа,
    СчетУчета,
    ВидОперации
