ВЫБРАТЬ
    Дата,
    Контрагент,
    ДоговорКонтрагента,
    НоменклатурнаяГруппа,
    СУММА(РеализацияКоличество) КАК РеализацияКоличество,
    СУММА(РеализацияСумма) КАК РеализацияСумма,
    СУММА(ФактКоличество) КАК ФактКоличество,
    СУММА(ФактСумма) КАК ФактСумма,
    СУММА(КорректировкаКоличество) КАК КорректировкаКоличество,
    СУММА(КорректировкаСумма) КАК КорректировкаСумма
ИЗ
(
    // ------------------ Реализация ------------------
    ВЫБРАТЬ
        НАЧАЛОПЕРИОДА(Реализация.Дата, ДЕНЬ) КАК Дата,
        Реализация.Контрагент КАК Контрагент,
        Реализация.ДоговорКонтрагента КАК ДоговорКонтрагента,
        ЕСТЬNULL(РТУТовары.Субконто, РТУУслуг.Субконто) КАК НоменклатурнаяГруппа,
        СУММА(ЕСТЬNULL(РТУТовары.Количество,0) + ЕСТЬNULL(РТУУслуг.Количество,0)) КАК РеализацияКоличество,
        СУММА(ЕСТЬNULL(РТУТовары.Сумма,0) + ЕСТЬNULL(РТУУслуг.Сумма,0)) КАК РеализацияСумма,
        0 КАК ФактКоличество,
        0 КАК ФактСумма,
        0 КАК КорректировкаКоличество,
        0 КАК КорректировкаСумма
    ИЗ
        Документ.РеализацияТоваровУслуг КАК Реализация
        ЛЕВОЕ СОЕДИНЕНИЕ Документ.РеализацияТоваровУслуг.Товары КАК РТУТовары
            ПО Реализация.Ссылка = РТУТовары.Ссылка
        ЛЕВОЕ СОЕДИНЕНИЕ Документ.РеализацияТоваровУслуг.Услуги КАК РТУУслуг
            ПО Реализация.Ссылка = РТУУслуг.Ссылка
    ГДЕ
        Реализация.Проведен
        И Реализация.Дата МЕЖДУ &ДатаНачала И &ДатаОкончания
        И Реализация.Склад.Наименование ПОДОБНО "%Склад отгрузки готовой продукции%"
        И СОКРЛ(СОКРП(Реализация.ПодразделениеОрганизации.Код)) = "53"
    СГРУППИРОВАТЬ ПО
        НАЧАЛОПЕРИОДА(Реализация.Дата, ДЕНЬ),
        Реализация.Контрагент,
        Реализация.ДоговорКонтрагента,
        ЕСТЬNULL(РТУТовары.Субконто, РТУУслуг.Субконто)

    // ------------------ Факт ------------------
    ОБЪЕДИНИТЬ ВСЕ
    ВЫБРАТЬ
        НАЧАЛОПЕРИОДА(Факт. Период, ДЕНЬ) КАК Дата,
        Факт.Контрагент,
        Факт.ДоговорКонтрагента,
        Факт.НоменклатурнаяГруппа,
        0 КАК РеализацияКоличество,
        0 КАК РеализацияСумма,
        СУММА(Факт.Количество) КАК ФактКоличество,
        СУММА(Факт.Сумма) КАК ФактСумма,
        0 КАК КорректировкаКоличество,
        0 КАК КорректировкаСумма
    ИЗ
        Документ.бит_ПолучениеФактическихДанных.ФактическиеДанные КАК Факт
    ГДЕ
        Факт.Ссылка.Проведен
        И Факт.Период МЕЖДУ &ДатаНачала И &ДатаОкончания
        И Факт.Ссылка.Сценарий.Наименование = "ФАКТ"
        И Факт.СтатьяОборотов.ТипСтатьи = ЗНАЧЕНИЕ(Перечисление.бит_ТипыСтатейОборотов.БДР)
    СГРУППИРОВАТЬ ПО
        НАЧАЛОПЕРИОДА(Факт.Период, ДЕНЬ),
        Факт.Контрагент,
        Факт.ДоговорКонтрагента,
        Факт.НоменклатурнаяГруппа

    // ------------------ Корректировка ------------------
    ОБЪЕДИНИТЬ ВСЕ
    ВЫБРАТЬ
        НАЧАЛОПЕРИОДА(Корректировка.Дата, ДЕНЬ) КАК Дата,
        Корректировка.Контрагент,
        Корректировка.ДоговорКонтрагента,
        ЕСТЬNULL(КоррТовары.Субконто, 0) КАК НоменклатурнаяГруппа,
        0 КАК РеализацияКоличество,
        0 КАК РеализацияСумма,
        0 КАК ФактКоличество,
        0 КАК ФактСумма,
        СУММА(ЕСТЬNULL(КоррТовары.Количество,0) + ЕСТЬNULL(КоррУслуги.Количество,0)) КАК КорректировкаКоличество,
        СУММА(ЕСТЬNULL(КоррТовары.Сумма,0) + ЕСТЬNULL(КоррУслуги.Сумма,0)) КАК КорректировкаСумма
    ИЗ
        Документ.КорректировкаРеализации КАК Корректировка
        ЛЕВОЕ СОЕДИНЕНИЕ Документ.КорректировкаРеализации.Товары КАК КоррТовары
            ПО Корректировка.Ссылка = КоррТовары.Ссылка
        ЛЕВОЕ СОЕДИНЕНИЕ Документ.КорректировкаРеализации.Услуги КАК КоррУслуги
            ПО Корректировка.Ссылка = КоррУслуги.Ссылка
    ГДЕ
        Корректировка.Дата МЕЖДУ &ДатаНачала И &ДатаОкончания
    СГРУППИРОВАТЬ ПО
        НАЧАЛОПЕРИОДА(Корректировка.Дата, ДЕНЬ),
        Корректировка.Контрагент,
        Корректировка.ДоговорКонтрагента,
        ЕСТЬNULL(КоррТовары.Субконто, 0)
) КАК Объединение
СГРУППИРОВАТЬ ПО
    Дата,
    Контрагент,
    ДоговорКонтрагента,
    НоменклатурнаяГруппа
УПОРЯДОЧИТЬ ПО
    Дата,
    Контрагент,
    ДоговорКонтрагента
