ВЫБРАТЬ
    Дата,
    Контрагент,
    ДоговорКонтрагента,
    Субконто,
    Количество,
    Сумма,
    СчетУчета
ИЗ
(
    /////////////////////// ТОВАРЫ //////////////////////
    ВЫБРАТЬ
        Реализация.Дата КАК Дата,
        Реализация.Контрагент КАК Контрагент,
        Реализация.ДоговорКонтрагента КАК ДоговорКонтрагента,
        РТУТовары.Субконто КАК Субконто,
        СУММА(РТУТовары.Количество) КАК Количество,
        0 КАК Сумма,
        РТУТовары.СчетРасходов КАК СчетУчета
    ИЗ
        Документ.РеализацияТоваровУслуг КАК Реализация
            ЛЕВОЕ СОЕДИНЕНИЕ Документ.РеализацияТоваровУслуг.Товары КАК РТУТовары
            ПО Реализация.Ссылка = РТУТовары.Ссылка
    ГДЕ
        Реализация.Проведен
        И Реализация.Дата МЕЖДУ &ДатаНачала И &ДатаОкончания
        И Реализация.Склад.Наименование ПОДОБНО "%Склад отгрузки готовой продукции%"
        И СОКРЛ(СОКРП(Реализация.ПодразделениеОрганизации.Код)) = "53"
    СГРУППИРОВАТЬ ПО
        Реализация.Контрагент,
        Реализация.ДоговорКонтрагента,
        Реализация.Дата,
        РТУТовары.Субконто,
        РТУТовары.СчетРасходов

    ОБЪЕДИНИТЬ ВСЕ

    /////////////////////// УСЛУГИ //////////////////////
    ВЫБРАТЬ
        Реализация.Дата КАК Дата,
        Реализация.Контрагент КАК Контрагент,
        Реализация.ДоговорКонтрагента КАК ДоговорКонтрагента,
        РТУУслуги.Субконто КАК Субконто,
        РТУУслуги.Количество КАК Количество,
        РТУУслуги.Сумма КАК Сумма,
        NULL КАК СчетУчета
    ИЗ
        Документ.РеализацияТоваровУслуг КАК Реализация
            ЛЕВОЕ СОЕДИНЕНИЕ Документ.РеализацияТоваровУслуг.Услуги КАК РТУУслуги
            ПО Реализация.Ссылка = РТУУслуги.Ссылка
    ГДЕ
        Реализация.Проведен
        И Реализация.Дата МЕЖДУ &ДатаНачала И &ДатаОкончания
        И Реализация.Склад.Наименование ПОДОБНО "%Склад отгрузки готовой продукции%"
        И СОКРЛ(СОКРП(Реализация.ПодразделениеОрганизации.Код)) = "53"

    ОБЪЕДИНИТЬ ВСЕ

    /////////////////////// ФАКТ //////////////////////
    ВЫБРАТЬ
        ФактическиеДанные.Период КАК Дата,
        ФактическиеДанные.Контрагент КАК Контрагент,
        ФактическиеДанные.ДоговорКонтрагента КАК ДоговорКонтрагента,
        ФактическиеДанные.НоменклатурнаяГруппа КАК Субконто,
        СУММА(ФактическиеДанные.Количество) КАК Количество,
        СУММА(ФактическиеДанные.Сумма) КАК Сумма,
        NULL КАК СчетУчета
    ИЗ
        Документ.бит_ПолучениеФактическихДанных.ФактическиеДанные КАК ФактическиеДанные
    ГДЕ
        ФактическиеДанные.Ссылка.Проведен
        И ФактическиеДанные.Ссылка.Сценарий.Наименование = "ФАКТ"
        И ФактическиеДанные.СтатьяОборотов.ТипСтатьи = ЗНАЧЕНИЕ(Перечисление.бит_ТипыСтатейОборотов.БДР)
        И ФактическиеДанные.СтатьяОборотов.Кодификатор ПОДОБНО "11.42.0[0-4][0-3]%"
    СГРУППИРОВАТЬ ПО
        ФактическиеДанные.ДоговорКонтрагента,
        ФактическиеДанные.Контрагент,
        ФактическиеДанные.НоменклатурнаяГруппа,
        ФактическиеДанные.Период
) КАК Подзапрос
